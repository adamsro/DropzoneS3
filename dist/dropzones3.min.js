(function(){var e,t,i,n,s,r,o,a,l,u,c,d,p,h=[].slice,f={}.hasOwnProperty,m=function(e,t){function i(){this.constructor=e}for(var n in t)f.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};a=function(){},u=function(){var e,t,i,n,s,r;for(n=arguments[0],i=2<=arguments.length?h.call(arguments,1):[],s=0,r=i.length;r>s;s++){t=i[s];for(e in t)t[e]&&t[e].constructor&&t[e].constructor===Object?(n[e]=n[e]||{},arguments.callee(n[e],t[e])):n[e]=t[e]}return n},p=function(e,t){var i=e.split(".");return 1===i.length||""===i[0]&&2===i.length?t:i.pop().toLowerCase()},e=function(e){function t(e){this.settings=e}var i=function(e){var t=encodeURIComponent(e);return t=t.replace(/[^A-Za-z0-9_.~\-%]+/g,escape),t=t.replace(/;/g,"%3B"),t=t.replace(/[*]/g,function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})},n=function(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(i);return t.sort()},s=function(e){return[e.getUTCFullYear(),r(e.getUTCMonth()+1,2),r(e.getUTCDate(),2),"T",r(e.getUTCHours(),2),r(e.getUTCMinutes(),2),r(e.getUTCSeconds(),2),"Z"].join("")},r=function(e,t){return("00000000000"+e).substr(-t)},o=function(e){return e&&"us"!==e.slice(0,2)?"-"+e:""};return t.prototype.send=function(e){var t=this;t.request_date=new Date,t.headers=t.settings.headers,t.headers.host=t.settings.auth.bucket+".s3"+o(t.settings.auth.region)+".amazonaws.com";var n=[t.settings.auth.date.getUTCFullYear(),r(t.settings.auth.date.getUTCMonth()+1,2),r(t.settings.auth.date.getUTCDate(),2)].join("");t.settings.querystring["X-Amz-Date"]=i(s(t.request_date)),t.settings.querystring["X-Amz-Algorithm"]="AWS4-HMAC-SHA256",t.settings.querystring["X-Amz-Expires"]=86400,t.settings.querystring["X-Amz-Credential"]=i([t.settings.auth.access_key,"/"+n+"/",t.settings.auth.region+"/s3/aws4_request"].join("")),t.settings.querystring["X-Amz-SignedHeaders"]="";var a=[];for(var l in t.headers)a.push(l);a.sort(),t.settings.querystring["X-Amz-SignedHeaders"]=i(a.join(";")),t.settings.querystring["X-Amz-Signature"]=t.get_authorization_header();var u=location.protocol+"//"+t.headers.host+"/"+t.settings.key;delete t.headers.host;var c=!0;for(var d in t.settings.querystring)t.settings.querystring.hasOwnProperty(d)&&(c&&(u+="?"),c=!1,u+=d+"="+t.settings.querystring[d]+"&");u=u.slice(0,-1);var p=new XMLHttpRequest;p.timeout=t.settings.timeout||0,p.addEventListener("load",t.settings.load_callback,!0),p.addEventListener("readystatechange",t.settings.state_change_callback),p.addEventListener("error",t.settings.error_callback,!0),p.upload.addEventListener("progress",t.settings.progress_callback),p.addEventListener("timeout",t.settings.timeout_callback),t.settings.method=t.settings.method||"GET",p.open(t.settings.method,u,!0);for(var h in t.headers)p.setRequestHeader(h,t.headers[h]);t.settings.payload?p.send(t.settings.payload):p.send(),e&&e(p)},t.prototype.get_authorization_header=function(){if(!this.settings.auth.date)throw"Invalid date given.";for(var e=n(this.headers),t="",i=0;i<e.length;i++)t+=e[i].toLowerCase()+";";t=t.slice(0,-1);var s=this.get_canonical_request(),r=this.get_string_to_sign(s,this.request_date),o=this.sign_request(r);return o},t.prototype.get_canonical_request=function(){var e="";e+=this.settings.method.toUpperCase()+"\n",e+="/"+i(this.settings.key).replace(/%2F/g,"/")+"\n";var t,s,r,o=n(this.settings.querystring);for(r=0;r<o.length;r++)t=o[r],s=this.settings.querystring[t],e+=i(t)+"="+s+"&amp;";e=e.slice(0,-"&amp;".length)+"\n";var a=n(this.headers);for(r=0;r<a.length;r++)t=a[r],s=this.headers[t],e+=t.toLowerCase()+":"+s.trim()+"\n";for(e+="\n",r=0;r<a.length;r++)e+=a[r].toLowerCase()+";";return e=e.slice(0,-1)+"\n",e+="UNSIGNED-PAYLOAD"},t.prototype.get_string_to_sign=function(t,i){var n="";return n+="AWS4-HMAC-SHA256\n",n+=s(i)+"\n",n+=[i.getUTCFullYear(),r(i.getUTCMonth()+1,2),r(i.getUTCDate(),2),"/"+this.settings.auth.region+"/s3/aws4_request\n"].join(""),n+=e.SHA256(t.replace(/&amp;/g,"&")).toString()},t.prototype.sign_request=function(t){if(!this.settings.auth.signature)throw"No signature provided.";var i=e.HmacSHA256(t,e.enc.Hex.parse(this.settings.auth.signature)).toString();return i},t}(CryptoJS),e.init=function(t,i,n,s,r,o){var a={auth:t,key:n,method:"POST",querystring:{uploads:""},headers:{"x-amz-acl":t.acl,"Content-Disposition":"attachment; filename="+escape(i.name),"Content-Type":i.type||"application/octet-stream"},payload:"",load_callback:r,error_callback:o,timeout:2e4,timeout_callback:o};return s&&(a.headers["x-amz-server-side-encryption"]="AES256"),new e(a).send()},e.list=function(t,i,n,s,r,o,a,l){var u={uploadId:s};return l&&(u["part-number-marker"]=l),new e({auth:t,key:n,method:"GET",querystring:u,headers:{},payload:"",error_callback:a,load_callback:function(l){if(l.target.status/100!=2)return a(l);for(var u=l.target.responseXML,c=[],d=u.getElementsByTagName("Part"),p=Math.ceil(i.size/r),h=0;h<d.length;h++){var f=parseInt(d[h].getElementsByTagName("PartNumber")[0].textContent,10),m=d[h].getElementsByTagName("ETag")[0].textContent,g=parseInt(d[h].getElementsByTagName("Size")[0].textContent,10);(f==p||g==r)&&(f!=p||g==i.size%r)&&c.push([f,m,g])}var v=u.getElementsByTagName("IsTruncated")[0].textContent;if("true"===v){var y=u.getElementsByTagName("NextPartNumberMarker")[0].textContent;e.list(t,n,s,r,function(e){o(c.concat(e))},a,y)}else o(c)},timeout:2e4,timeout_callback:a}).send()},e.uploadChunk=function(t,i,n,s,r,o,a){var l={partNumber:s+1,uploadId:n};return new e({auth:t,key:i,method:"PUT",querystring:l,headers:{},payload:r,load_callback:o.load_callback,error_callback:o.error_callback,progress_callback:o.progress_callback}).send(a)},e.finish=function(t,i,n,s,r,o,a,l){for(var u={uploadId:s},c="<CompleteMultipartUpload>",d=0;d<r.length;d++)c+="<Part>",c+="<PartNumber>"+r[d][0]+"</PartNumber>",c+="<ETag>"+r[d][1]+"</ETag>",c+="</Part>";return c+="</CompleteMultipartUpload>",-1!==navigator.userAgent.indexOf("Firefox")&&(c=new Blob([c])),new e({auth:t,key:n,method:"POST",querystring:u,headers:{},payload:c,load_callback:a,error_callback:l,timeout:2e4,timeout_callback:l}).send()},e.exists=function(t,i,n,s){return new e({auth:t,key:i,method:"HEAD",querystring:{},headers:{},payload:"",load_callback:function(e){return n(e.target.status/100==2?!0:!1)},error_callback:s,timeout:2e4,timeout_callback:s}).send()},e.abort=function(t,i,n,s,r){return new e({auth:t,key:i,method:"DELETE",querystring:{uploadId:n},headers:{},payload:"",load_callback:function(e){return e.target.status/100==2?s():r(e)},error_callback:r,timeout:2e4,timeout_callback:r}).send()},t=function(e){function t(e,t){this.file=e,this.totalBytes=0,this.chunks=[],this.chunkSize=t||5242880}t.CHUNK_QUEUED="queued",t.CHUNK_UPLOADING="uploading",t.CHUNK_SUCCESS="success";var i=function(e,i){var n=Math.ceil(e/i);chunks=new Array(n);for(var s=0;n>s;s++)chunks[s]={status:t.CHUNK_QUEUED,bytesSent:0,progressDate:!1};return chunks},n=function(e,n,s){for(var r=i(n,s),o=0;o<e.length;o++){var a=parseInt(e[o][0],10);r[a-1].status=t.CHUNK_SUCCESS,r[a-1].bytesSent=s}return r};return t.prototype.init=function(t,s,r,o,a){var l=this;this.auth=t,this.auth.date=new Date(t.date),this.key=s,this.auth.uploadId?e.list(this.auth,this.file,this.key,this.auth.uploadId,this.chunkSize,function(e){l.chunks=n(e,l.file.size,l.chunkSize),o(!1)},function(t){404===t.target.status&&-1!==t.target.responseText.indexOf("NoSuchUpload")?e.exists(l.auth,l.key,function(e){if(e){l.chunks=i(l.file.size,l.chunkSize);for(var t=l.chunks.length-1;t>=0;t--)l.setChunkComplete(chunks[t]);o(!0)}else l.auth.uploadId=null,l.init(l.auth,l.key,r,o,a)},function(){a(t)}):a(t)}):e.init(this.auth,this.file,this.key,r,function(e){if(e.target.status/100!==2)return a(e);var t=e.target.responseXML;l.auth.uploadId=t.getElementsByTagName("UploadId")[0].textContent,l.chunks=i(l.file.size,l.chunkSize),o(!1)},a)},t.prototype.getNextQueuedChunk=function(){for(var e=0,i=this.chunks.length;i>e;e++)if(this.chunks[e].status===t.CHUNK_QUEUED)return e;return!1},t.prototype.getUploadingChunks=function(){for(var e=[],i=0,n=this.chunks.length;n>i;i++)this.chunks[i].status===t.CHUNK_UPLOADING&&e.push(i);return e?e:!1},t.prototype.chunksSuccessful=function(){for(var e=0,i=this.chunks.length;i>e;e++)if(this.chunks[e].status!==t.CHUNK_SUCCESS)return!1;return!0},t.prototype.uploadChunk=function(i,n,s,r){var o=this,a=function(e){e.target.status/100==2?n(e):s(e)},l={load_callback:a,error_callback:s,progress_callback:r},u=this.chunks[i],c=this.chunkSize,d=i*c,p=Math.min(d+c,this.file.size);u.status=t.CHUNK_UPLOADING,u.progressDate=new Date,e.uploadChunk(this.auth,this.key,this.auth.uploadId,i,this.file.slice(d,p),l,function(e){u.xhr=e,u.interval=setInterval(function(e){e.progressDate&&new Date-e.progressDate>15e3&&(clearInterval(e.interval),o.getUploadingChunks()&&(e.xhr.abort(),s(e.xhr)))}(u),4e3)})},t.prototype.setChunkProgress=function(e,t){this.chunks[e].bytesSent=t,this.totalBytes=0;for(var i=this.chunks.length-1;i>=0;i--)this.totalBytes+=this.chunks[i].bytesSent},t.prototype.setChunkComplete=function(e){var i=this.chunks.length-1==e?this.file.size%this.chunkSize:this.chunkSize;this.setChunkProgress(e,i),clearInterval(this.chunks[e].interval),this.chunks[e].status=t.CHUNK_SUCCESS},t.prototype.resetChunk=function(e){this.setChunkProgress(e,0),clearInterval(this.chunks[e].interval),this.chunks[e].status=t.CHUNK_QUEUED},t.prototype.getTotalProgress=function(){return this.totalBytes/this.file.size*100},t.prototype.getBytesSent=function(){return this.totalBytes},t.prototype.reset=function(){this.totalProgress=0,this.auth=null,this.chunks=[]},t.prototype.abort=function(t,i){for(var n=this.chunks.length-1;n>=0;n--)this.chunks[n].hasOwnProperty("xhr")&&this.chunks[n].xhr.abort();e.abort(this.auth,this.key,this.auth.uploadId,t,i),this.reset()},t.prototype.finishUpload=function(t,i,s){var r=this;e.list(this.auth,this.file,this.key,this.auth.uploadId,this.chunkSize,function(o){o.length!=r.chunks.length?(r.chunks=n(o,r.file.size,r.chunkSize),i()):e.finish(r.auth,r.file,r.key,r.auth.uploadId,o,r.chunkSize,function(n){n.target.status/100==2?t(n):400==n.target.status&&-1!==n.target.responseText.indexOf("EntityTooSmall")?this.file.upload.finishUpload(t,i,s):404===n.target.status&&-1!==n.target.responseText.indexOf("NoSuchUpload")?e.exists(r.auth,r.key,function(e){return e?t(n):s(n)},s):s(n)},s)},function(i){404==i.target.status&&-1!==i.target.responseText.indexOf("NoSuchUpload")?e.exists(r.auth,r.key,function(e){return e?t(i):s(i)},s):s(i)})},t}(e),i=function(){function e(){}return e.prototype.addEventListener=e.prototype.on,e.prototype.on=function(e,t){return this._callbacks=this._callbacks||{},this._callbacks[e]||(this._callbacks[e]=[]),this._callbacks[e].push(t),this},e.prototype.emit=function(){var e,t,i,n,s,r;if(n=arguments[0],e=2<=arguments.length?h.call(arguments,1):[],this._callbacks=this._callbacks||{},i=this._callbacks[n])for(s=0,r=i.length;r>s;s++)t=i[s],t.apply(this,e);return this},e.prototype.removeListener=e.prototype.off,e.prototype.removeAllListeners=e.prototype.off,e.prototype.removeEventListener=e.prototype.off,e.prototype.off=function(e,t){var i,n,s,r,o;if(!this._callbacks||0===arguments.length)return this._callbacks={},this;if(n=this._callbacks[e],!n)return this;if(1===arguments.length)return delete this._callbacks[e],this;for(s=r=0,o=n.length;o>r;s=++r)if(i=n[s],i===t){n.splice(s,1);break}return this},e}(),n=function(e){function n(e,t){var i,s,r;if(this.element=e,this.version=n.version,this.defaultOptions.previewTemplate=this.defaultOptions.previewTemplate.replace(/\n*/g,""),this.clickableElements=[],this.listeners=[],this.files=[],this.dummyFiles=[],"string"==typeof this.element&&(this.element=document.querySelector(this.element)),!this.element||null==this.element.nodeType)throw new Error("Invalid dropzone element.");if(this.element.dropzone)throw new Error("DropzoneS3 already attached.");if(n.instances.push(this),this.element.dropzone=this,i=null!==(r=n.optionsForElement(this.element))?r:{},this.options=u({},this.defaultOptions,i,null!==t?t:{}),!this.options.s3.bucket||!this.options.s3.accesskey)throw new Error("Amazon S3 bucket and access key must be set.");return this.options.forceFallback||!n.isBrowserSupported()?this.options.fallback.call(this):(this.options.resuming.localStorageResume===!0&&null==this.options.resuming.localStoragePrefix&&(this.options.resuming.localStoragePrefix=this.element.id||"ds3"),(s=this.getExistingFallback())&&s.parentNode&&s.parentNode.removeChild(s),this.options.previewsContainer!==!1&&(this.options.previewsContainer?this.previewsContainer=n.getElement(this.options.previewsContainer,"previewsContainer"):this.previewsContainer=this.element),this.options.clickable&&(this.options.clickable===!0?this.clickableElements=[this.element]:this.clickableElements=n.getElements(this.options.clickable,"clickable")),void this.init())}return m(n,e),n.prototype.Emitter=i,n.prototype.events=["drop","dragstart","dragend","dragenter","dragover","dragleave","duplicate","addedfile","removedfile","thumbnail","error","sign","filesigned","fileinit","enqueuing","uploadprogress","totaluploadprogress","sending","notify","success","canceled","complete","reset","maxfilesexceeded","maxfilesreached","queuecomplete","pause","resume","resumed"],n.prototype.defaultOptions={s3:{region:"us-east-1",bucket:null,accesskey:null,acl:"private",ssencrypt:!1},signing:{endpoint:"/dropzones3/sign",params:{}},notifying:{notify:!1,endpoint:"/dropzones3/notify",params:{}},chunking:{maxConcurrentWorkers:6,maxChunkSize:5242880},resuming:{automaticRetry:!0,localStorageResume:!0,localStoragePrefix:null,retryAttempts:0,retryInterval:10},thumbnails:{createImageThumbnails:!0,maxThumbnailFilesize:10,thumbnailWidth:120,thumbnailHeight:120},validation:{maxFiles:null,maxFilesize:1e4,allowDuplicates:!1,acceptedFiles:null},paramName:"file",clickable:!0,ignoreHiddenFiles:!0,filesizeBase:1e3,autoQueue:!0,addRemoveLinks:!0,previewsContainer:null,capture:null,dictDefaultMessage:"Drop files here to upload",dictFallbackMessage:"Your browser does not support drag'n'drop file uploads.",dictFallbackText:"Please use the fallback form below to upload your files like in the olden days.",dictFileTooBig:"File is too big ({{filesize}}MiB). Max filesize: {{maxFilesize}}MiB.",dictInvalidFileType:"You can't upload files of this type.",dictResponseError:"Server responded with {{statusCode}} code.",dictConnectionError:"Connection error. Will retry upload in {{seconds}} seconds.",dictCancelUpload:"Cancel upload",dictResumeUpload:"Connection Error. Click to resume.",dictCancelUploadConfirmation:"Are you sure you want to cancel this upload?",dictRemoveFile:"Remove file",dictRemoveFileConfirmation:null,dictMaxFilesExceeded:"You can not upload any more files.",accept:function(e,t){return t()},init:function(){return a},forceFallback:!1,fallback:function(){var e,t,i,s,r,o;for(this.element.className=""+this.element.className+" dzs3-browser-not-supported",o=this.element.getElementsByTagName("div"),s=0,r=o.length;r>s;s++)e=o[s],/(^| )dzs3-message($| )/.test(e.className)&&(t=e,e.className="dzs3-message");return t||(t=n.createElement('<div class="dzs3-message"><span></span></div>'),this.element.appendChild(t)),i=t.getElementsByTagName("span")[0],i&&(i.textContent=this.options.dictFallbackMessage),this.element.appendChild(this.getFallbackForm())},resize:function(e){var t,i,n;return t={srcX:0,srcY:0,srcWidth:e.width,srcHeight:e.height},i=e.width/e.height,t.optWidth=this.options.thumbnails.thumbnailWidth,t.optHeight=this.options.thumbnails.thumbnailHeight,null==t.optWidth&&null==t.optHeight?(t.optWidth=t.srcWidth,t.optHeight=t.srcHeight):null==t.optWidth?t.optWidth=i*t.optHeight:null==t.optHeight&&(t.optHeight=1/i*t.optWidth),n=t.optWidth/t.optHeight,e.height<t.optHeight||e.width<t.optWidth?(t.trgHeight=t.srcHeight,t.trgWidth=t.srcWidth):i>n?(t.srcHeight=e.height,t.srcWidth=t.srcHeight*n):(t.srcWidth=e.width,t.srcHeight=t.srcWidth/n),t.srcX=(e.width-t.srcWidth)/2,t.srcY=(e.height-t.srcHeight)/2,t},drop:function(e){return this.element.classList.remove("dzs3-drag-hover")},dragstart:a,dragend:function(e){return this.element.classList.remove("dzs3-drag-hover")},dragenter:function(e){return this.element.classList.add("dzs3-drag-hover")},dragover:function(e){return this.element.classList.add("dzs3-drag-hover")},dragleave:function(e){return this.element.classList.remove("dzs3-drag-hover")},paste:a,reset:function(){return this.element.classList.remove("dzs3-started")},duplicate:function(e,t){if(e.previewElement){var i=function(t,n){e.previewElement.classList.remove("dzs3-duplicate-attempt"),e.previewElement.removeEventListener("transitionend",i,!0)};e.previewElement.addEventListener("transitionend",i,!0),e.previewElement.classList.add("dzs3-duplicate-attempt")}},addedfile:function(e){var t,i,s,r,o,a,l,u,c,d,h,f,m,g;if(this.element===this.previewsContainer&&this.element.classList.add("dzs3-started"),this.previewsContainer){for(e.previewElement=n.createElement(this.options.previewTemplate.trim()),e.previewTemplate=e.previewElement,this.previewsContainer.appendChild(e.previewElement),d=e.previewElement.querySelectorAll("[data-dzs3-name]"),r=0,l=d.length;l>r;r++)t=d[r],t.textContent=e.name;for(h=e.previewElement.querySelectorAll("[data-dzs3-size]"),o=0,u=h.length;u>o;o++)t=h[o],t.innerHTML=this.filesize(e.size);var v=p(e.name,"generic");for(m=e.previewElement.querySelectorAll("[data-dzs3-thumb-container]"),o=0,u=m.length;u>o;o++)m[o].classList.add("dzs3-ext-"+v);for(this.options.addRemoveLinks&&(e._removeLink=n.createElement('<a class="dzs3-remove" href="javascript:undefined;" data-dzs3-remove>'+this.options.dictRemoveFile+"</a>"),e.previewElement.appendChild(e._removeLink)),i=function(t){return function(i){return i.preventDefault(),i.stopPropagation(),e.status===n.UPLOADING?n.confirm(t.options.dictCancelUploadConfirmation,function(){return t.removeFile(e)}):t.options.dictRemoveFileConfirmation?n.confirm(t.options.dictRemoveFileConfirmation,function(){return t.removeFile(e)}):t.removeFile(e)}}(this),f=e.previewElement.querySelectorAll("[data-dzs3-remove]"),g=[],a=0,c=f.length;c>a;a++)s=f[a],g.push(s.addEventListener("click",i))}},removedfile:function(e){var t;return e.previewElement&&null!=(t=e.previewElement)&&t.parentNode.removeChild(e.previewElement),this._updateMaxFilesReachedClass()},thumbnail:function(e,t){var i,n,s,r;if(e.previewElement){for(e.previewElement.classList.remove("dzs3-file-preview"),r=e.previewElement.querySelectorAll("[data-dzs3-thumbnail]"),n=0,s=r.length;s>n;n++)i=r[n],i.alt=e.name,i.src=t;return setTimeout(function(t){return function(){return e.previewElement.classList.add("dzs3-image-preview")}}(this),1)}},error:function(e,t){var i,n,s,r,o;if(e.previewElement){for(e.previewElement.classList.add("dzs3-error"),"String"!=typeof t&&t.error&&(t=t.error),r=e.previewElement.querySelectorAll("[data-dzs3-errormessage]"),o=[],n=0,s=r.length;s>n;n++)i=r[n],o.push(i.textContent=t);return o}},sign:function(e){e.previewElement&&(e.previewElement.classList.add("dzs3-processing"),e._removeLink&&(e._removeLink.textContent=this.options.dictCancelUpload))},enqueuing:a,filesigned:function(e,t,i){i()},fileinit:function(e,t){t()},pause:function(e,t){var i=function(e,t){return function(n){n.preventDefault(),n.stopPropagation(),t.previewElement.removeEventListener("click",i),t.paused=!1,e.emit("resumed",t),e.resumeFile(t)}}(this,e);e.previewElement.classList.add("dzs3-paused"),e.previewElement.addEventListener("click",i),t||(t=""),"String"!=typeof t&&t.error&&(t=t.error);for(var n=e.previewElement.querySelectorAll("[data-dzs3-pausemessage]"),s=0,r=n.length;r>s;s++)n[s].textContent=t},resume:a,resumed:function(e){e.previewElement.classList.remove("dzs3-paused")},uploadprogress:function(e,t,i){var n,s,r,o,a;if(e.previewElement){for(o=e.previewElement.querySelectorAll("[data-dzs3-uploadprogress]"),a=[],s=0,r=o.length;r>s;s++)n=o[s],a.push("PROGRESS"===n.nodeName?n.value=t:n.style.width=""+t+"%");return a}},totaluploadprogress:a,sending:a,notify:function(e,t){if(this.options.notifying.notify){var i=this,s=new XMLHttpRequest;e.status=n.NOTIFYING,s.onload=function(){if(s.status/100!=2)return s.status/100==5?i._recoverableError(e,s):i._fatalError(e,i.options.dictResponseError.replace("{{statusCode}}",s.status),s);try{var n=JSON.parse(s.responseText);e.fid=n.fid,t(e)}catch(r){i._fatalError(e,r.message)}},s.onerror=s.ontimeout=function(t){return i._recoverableError(e,t.target)},s.timeout=2e4;var r={filename:e.name,filesize:e.size,filemime:e.type,key:e.upload.auth.key};u(r,this.options.notifying.params),s.open("POST",this.options.notifying.endpoint,!0),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.send(c(r))}else t(e)},success:function(e){return e.previewElement?e.previewElement.classList.add("dzs3-success"):void 0},canceled:function(e){return this.emit("error",e,"Upload canceled.")},complete:function(e){return e._removeLink&&(e._removeLink.textContent=this.options.dictRemoveFile),e.previewElement?e.previewElement.classList.add("dzs3-complete"):void 0},maxfilesexceeded:a,maxfilesreached:a,queuecomplete:a,previewTemplate:'<div class="dzs3-preview dzs3-file-preview"><div class="dzs3-image dzs3-ext" data-dzs3-thumb-container><img data-dzs3-thumbnail /></div><div class="dzs3-details"><div class="dzs3-size"><span data-dzs3-size></span></div><div class="dzs3-filename"><span data-dzs3-name></span></div></div><div class="dzs3-progress"><span class="dzs3-upload" data-dzs3-uploadprogress></span></div><div class="dzs3-error-message"><span data-dzs3-errormessage></span></div><div class="dzs3-pause-message"><span data-dzs3-pausemessage></span></div><div class="dzs3-success-mark"><svg xmlns="http://www.w3.org/2000/svg" width="54" height="54" viewBox="0 0 54 54" version="1.1"><title>Check</title><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M23.5 31.8L17.6 25.9C16 24.4 13.5 24.4 11.9 25.9 10.4 27.5 10.4 30 11.9 31.6L20.4 40.1C20.5 40.2 20.6 40.3 20.7 40.3 22.3 41.9 24.8 41.9 26.3 40.3L43.3 23.3C44.9 21.8 44.9 19.2 43.3 17.7 41.8 16.1 39.2 16.1 37.7 17.7L23.5 31.8ZM27 53C41.4 53 53 41.4 53 27 53 12.6 41.4 1 27 1 12.6 1 1 12.6 1 27 1 41.4 12.6 53 27 53Z" stroke-opacity="0.2" stroke="#747474" fill-opacity="0.8" fill="#FFFFFF"/></g></svg></div><div class="dzs3-error-mark"><svg xmlns="http://www.w3.org/2000/svg" width="54" height="54" viewBox="0 0 54 54" version="1.1"><title>Error</title><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g stroke="#747474" stroke-opacity="0.2" fill="#FFFFFF" fill-opacity="0.8"><path d="M32.7 29L38.3 23.3C39.9 21.8 39.9 19.2 38.3 17.7 36.8 16.1 34.2 16.1 32.7 17.7L27 23.3 21.3 17.7C19.8 16.1 17.2 16.1 15.7 17.7 14.1 19.2 14.1 21.8 15.7 23.3L21.3 29 15.7 34.7C14.1 36.2 14.1 38.8 15.7 40.3 17.2 41.9 19.8 41.9 21.3 40.3L27 34.7 32.7 40.3C34.2 41.9 36.8 41.9 38.3 40.3 39.9 38.8 39.9 36.2 38.3 34.7L32.7 29ZM27 53C41.4 53 53 41.4 53 27 53 12.6 41.4 1 27 1 12.6 1 1 12.6 1 27 1 41.4 12.6 53 27 53Z"/></g></g></svg></div><div class="dzs3-resume-mark"><svg xmlns="http://www.w3.org/2000/svg" width="54" height="54" viewBox="0 0 54 54" version="1.1"><title>Continue</title><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><path d="M27 53C41.4 53 53 41.4 53 27 53 12.6 41.4 1 27 1 12.6 1 1 12.6 1 27 1 41.4 12.6 53 27 53ZM16.9 19.9L13.2 19.9 13.2 33.9 16.9 33.9 16.9 19.9 16.9 19.9ZM19.9 19.9L29.1 19.9 29 13.6C29 12 30 11.5 31.3 12.6L46.4 25.1C47.7 26.1 47.7 27.8 46.4 28.9L31.6 41.1C30.3 42.1 29.2 41.6 29.2 40L29.2 33.9 29.2 33.9 19.9 33.9 19.9 19.9 19.9 19.9ZM10.2 19.9L10 19.9C8.3 19.9 7 21.2 7 22.9L7 30.9C7 32.5 8.3 33.9 10 33.9L10.2 33.9 10.2 19.9Z" stroke-opacity="0.2" stroke="#747474" fill-opacity="0.8" fill="#FFFFFF"/></g></svg></div></div>'},n.prototype.getAcceptedFiles=function(){var e,t,i,n,s;for(n=this.files,s=[],t=0,i=n.length;i>t;t++)e=n[t],e.accepted&&s.push(e);return s},n.prototype.getRejectedFiles=function(){var e,t,i,n,s;for(n=this.files,s=[],t=0,i=n.length;i>t;t++)e=n[t],e.accepted||s.push(e);return s},n.prototype.getFilesWithStatus=function(e){for(var t=[],i=0,n=this.files.length;n>i;i++)this.files[i].status===e&&t.push(this.files[i]);return t},n.prototype.getQueuedFiles=function(){return this.getFilesWithStatus(n.QUEUED)},n.prototype.getUploadingFiles=function(){return this.getFilesWithStatus(n.UPLOADING)},n.prototype.getActiveFiles=function(){for(var e=[],t=0,i=this.files.length;i>t;t++)(this.files[t].status===n.UPLOADING||this.files[t].status===n.QUEUED)&&e.push(this.files[t]);return e},n.prototype.getWorkerCount=function(){for(var e=0,t=0,i=this.files.length;i>t;t++)e+=this.files[t].upload.getUploadingChunks().length;return e},n.prototype.init=function(){var e,t,i,s,r,o,a;for("form"===this.element.tagName&&this.element.setAttribute("enctype","multipart/form-data"),this.element.classList.contains("dropzone")&&!this.element.querySelector(".dzs3-message")&&this.element.appendChild(n.createElement('<div class="dzs3-default dzs3-message"><span>'+this.options.dictDefaultMessage+"</span></div>")),this.clickableElements.length&&(i=function(e){return function(){return e.hiddenFileInput&&document.body.removeChild(e.hiddenFileInput),e.hiddenFileInput=document.createElement("input"),e.hiddenFileInput.setAttribute("type","file"),(null===e.options.validation.maxFiles||e.options.validation.maxFiles>1)&&e.hiddenFileInput.setAttribute("multiple","multiple"),e.hiddenFileInput.className="dzs3-hidden-input",null!==e.options.validation.acceptedFiles&&e.hiddenFileInput.setAttribute("accept",e.options.validation.acceptedFiles),null!==e.options.capture&&e.hiddenFileInput.setAttribute("capture",e.options.capture),e.hiddenFileInput.style.visibility="hidden",e.hiddenFileInput.style.position="absolute",e.hiddenFileInput.style.top="0",e.hiddenFileInput.style.left="0",e.hiddenFileInput.style.height="0",e.hiddenFileInput.style.width="0",document.body.appendChild(e.hiddenFileInput),e.hiddenFileInput.addEventListener("change",function(){var t,n,s,r;if(n=e.hiddenFileInput.files,n.length)for(s=0,r=n.length;r>s;s++)t=n[s],e.addFile(t);return i()})}}(this))(),this.URL=null!==(o=window.URL)?o:window.webkitURL,a=this.events,s=0,r=a.length;r>s;s++)e=a[s],this.on(e,this.options[e]);return this.on("uploadprogress",function(e){return function(){return e.updateTotalUploadProgress()}}(this)),this.on("removedfile",function(e){return function(){return e.updateTotalUploadProgress()}}(this)),this.on("canceled",function(e){return function(t){return e.emit("complete",t)}}(this)),this.on("complete",function(e){return function(t){return 0===e.getUploadingFiles().length&&0===e.getQueuedFiles().length?setTimeout(function(){return e.emit("queuecomplete")},0):void 0}}(this)),t=function(e){return e.stopPropagation(),e.preventDefault?e.preventDefault():e.returnValue=!1},this.listeners=[{element:this.element,events:{dragstart:function(e){return function(t){return e.emit("dragstart",t)}}(this),dragenter:function(e){return function(i){return t(i),e.emit("dragenter",i)}}(this),dragover:function(e){return function(i){var n;try{n=i.dataTransfer.effectAllowed}catch(s){}return i.dataTransfer.dropEffect="move"===n||"linkMove"===n?"move":"copy",t(i),e.emit("dragover",i)}}(this),dragleave:function(e){return function(t){return e.emit("dragleave",t)}}(this),drop:function(e){return function(i){return t(i),e.drop(i)}}(this),dragend:function(e){return function(t){return e.emit("dragend",t)}}(this)}}],this.clickableElements.forEach(function(e){return function(t){return e.listeners.push({element:t,events:{click:function(i){return t!==e.element||i.target===e.element||n.elementInside(i.target,e.element.querySelector(".dzs3-message"))?e.hiddenFileInput.click():void 0}}})}}(this)),this.enable(),this.options.init.call(this)},n.prototype.destroy=function(){var e;return this.disable(),this.removeAllFiles(!0),(null!=(e=this.hiddenFileInput)?e.parentNode:void 0)&&(this.hiddenFileInput.parentNode.removeChild(this.hiddenFileInput),this.hiddenFileInput=null),delete this.element.dropzone,n.instances.splice(n.instances.indexOf(this),1)},n.prototype.updateTotalUploadProgress=function(){var e,t,i,n,s,r,o,a;if(n=0,i=0,e=this.getActiveFiles(),e.length){for(a=this.getActiveFiles(),r=0,o=a.length;o>r;r++)t=a[r],n+=t.upload.bytesSent,i+=t.upload.total;s=100*n/i}else s=100;return this.emit("totaluploadprogress",s,i,n)},n.prototype._getParamName=function(e){return"function"==typeof this.options.paramName?this.options.paramName(e):""+this.options.paramName+(this.options.uploadMultiple?"["+e+"]":"")},n.prototype.getFallbackForm=function(){var e,t,i,s;return(e=this.getExistingFallback())?e:(i='<div class="dzs3-fallback">',this.options.dictFallbackText&&(i+="<p>"+this.options.dictFallbackText+"</p>"),i+='<input type="file" name="'+this._getParamName(0)+'" '+(this.options.uploadMultiple?'multiple="multiple"':void 0)+' /><input type="submit" value="Upload!"></div>',t=n.createElement(i),"FORM"!==this.element.tagName?(s=n.createElement('<form action="AWS_URL_HERE" enctype="multipart/form-data" method="POST"></form>'),s.appendChild(t)):(this.element.setAttribute("enctype","multipart/form-data"),this.element.setAttribute("method",this.options.method)),null!=s?s:t)},n.prototype.getExistingFallback=function(){var e,t,i,n,s,r;for(t=function(e){var t,i,n;for(i=0,n=e.length;n>i;i++)if(t=e[i],/(^| )fallback($| )/.test(t.className))return t},r=["div","form"],n=0,s=r.length;s>n;n++)if(i=r[n],e=t(this.element.getElementsByTagName(i)))return e},n.prototype.setupEventListeners=function(){var e,t,i,n,s,r,o;for(r=this.listeners,o=[],n=0,s=r.length;s>n;n++)e=r[n],o.push(function(){var n,s;n=e.events,s=[];for(t in n)i=n[t],s.push(e.element.addEventListener(t,i,!1));return s}());return o},n.prototype.removeEventListeners=function(){var e,t,i,n,s,r,o;for(r=this.listeners,o=[],n=0,s=r.length;s>n;n++)e=r[n],o.push(function(){var n,s;n=e.events,s=[];for(t in n)i=n[t],s.push(e.element.removeEventListener(t,i,!1));return s}());return o},n.prototype.disable=function(){var e,t,i,n,s;for(this.clickableElements.forEach(function(e){return e.classList.remove("dzs3-clickable")}),this.removeEventListeners(),n=this.files,s=[],t=0,i=n.length;i>t;t++)e=n[t],s.push(this.cancelUpload(e));return s},n.prototype.enable=function(){return this.clickableElements.forEach(function(e){return e.classList.add("dzs3-clickable")}),this.setupEventListeners()},n.prototype.filesize=function(e){var t,i,n,s,r,o,a,l;for(o=["TB","GB","MB","KB","b"],n=s=null,i=a=0,l=o.length;l>a;i=++a)if(r=o[i],t=Math.pow(this.options.filesizeBase,4-i)/10,e>=t){n=e/Math.pow(this.options.filesizeBase,4-i),s=r;break}return n=Math.round(10*n)/10,"<strong>"+n+"</strong> "+s},n.prototype._updateMaxFilesReachedClass=function(){return null!=this.options.validation.maxFiles&&this.getAcceptedFiles().length>=this.options.validation.maxFiles?(this.getAcceptedFiles().length===this.options.validation.maxFiles&&this.emit("maxfilesreached",this.files),this.element.classList.add("dzs3-max-files-reached")):this.element.classList.remove("dzs3-max-files-reached")},n.prototype.drop=function(e){var t,i;e.dataTransfer&&(this.emit("drop",e),t=e.dataTransfer.files,t.length&&(i=e.dataTransfer.items,i&&i.length&&null!=i[0].webkitGetAsEntry?this._addFilesFromItems(i):this.handleFiles(t)))},n.prototype.paste=function(e){var t,i;if(null!=(null!=e&&null!=(i=e.clipboardData)?i.items:void 0))return this.emit("paste",e),t=e.clipboardData.items,t.length?this._addFilesFromItems(t):void 0},n.prototype.handleFiles=function(e){var t,i,n,s;for(s=[],i=0,n=e.length;n>i;i++)t=e[i],s.push(this.addFile(t));return s},n.prototype._addFilesFromItems=function(e){var t,i,n,s,r;for(r=[],n=0,s=e.length;s>n;n++)i=e[n],r.push(null!=i.webkitGetAsEntry&&(t=i.webkitGetAsEntry())?t.isFile?this.addFile(i.getAsFile()):t.isDirectory?this._addFilesFromDirectory(t,t.name):void 0:null!=i.getAsFile?null===i.kind||"file"===i.kind?this.addFile(i.getAsFile()):void 0:void 0);return r},n.prototype._addFilesFromDirectory=function(e,t){
var i,n;return i=e.createReader(),n=function(e){return function(i){var n,s,r;for(s=0,r=i.length;r>s;s++)n=i[s],n.isFile?n.file(function(i){return e.options.ignoreHiddenFiles&&"."===i.name.substring(0,1)?void 0:(i.fullPath=""+t+"/"+i.name,e.addFile(i))}):n.isDirectory&&e._addFilesFromDirectory(n,""+t+"/"+n.name)}}(this),i.readEntries(n,function(e){return"undefined"!=typeof console&&null!==console&&"function"==typeof console.log?console.log(e):void 0})},n.prototype.addFile=function(e){var i=this;if(e.delta=this.files.length+this.dummyFiles.length,e.processed=!1,e.isDuplicate=!1,e.s3success=!1,e.retryAttemptsRemaining=this.options.resuming.retryAttempts,this.options.validation.allowDuplicates===!1&&this.files.length)for(var s=0,r=this.files.length;r>s;s++){var o=this.files[s];if(o&&o.name===e.name&&o.size===e.size&&o.lastModified===e.lastModified)switch(e.isDuplicate=!0,o.status){case n.ERROR:i.removeFile(o);break;case n.PAUSED:i.resumeFile(o);default:return void this.emit("duplicate",o,e)}}return e.upload=new t(e,this.options.chunking.maxChunkSize),this.files.push(e),e.status=n.ADDED,this.emit("addedfile",e),this._enqueueThumbnail(e),this.accept(e,function(t){return function(i){return i?(e.accepted=!1,t._fatalError(e,i)):(e.accepted=!0,t.options.autoQueue&&setTimeout(function(){return t.enqueueFile(e)},0)),t._updateMaxFilesReachedClass()}}(this))},n.prototype.accept=function(e,t){return e.size>1024*this.options.validation.maxFilesize*1024?t(this.options.dictFileTooBig.replace("{{filesize}}",Math.round(e.size/1024/10.24)/100).replace("{{maxFilesize}}",this.options.validation.maxFilesize)):n.isValidFile(e,this.options.validation.acceptedFiles)?null!=this.options.validation.maxFiles&&this.getAcceptedFiles().length+this.dummyFiles.length>=this.options.validation.maxFiles?(t(this.options.dictMaxFilesExceeded.replace("{{maxFiles}}",this.options.validation.maxFiles)),this.emit("maxfilesexceeded",e)):this.options.accept.call(this,e,t):t(this.options.dictInvalidFileType)},n.prototype._thumbnailQueue=[],n.prototype._processingThumbnail=!1,n.prototype._enqueueThumbnail=function(e){return this.options.thumbnails.createImageThumbnails&&e.type.match(/image.*/)&&e.size<=1024*this.options.thumbnails.maxThumbnailFilesize*1024?(this._thumbnailQueue.push(e),setTimeout(function(e){return function(){return e._processThumbnailQueue()}}(this),0)):void 0},n.prototype._processThumbnailQueue=function(){return this._processingThumbnail||0===this._thumbnailQueue.length?void 0:(this._processingThumbnail=!0,this.createThumbnail(this._thumbnailQueue.shift(),function(e){return function(){return e._processingThumbnail=!1,e._processThumbnailQueue()}}(this)))},n.prototype.createThumbnail=function(e,t){var i;return i=new FileReader,i.onload=function(n){return function(){return"image/svg+xml"===e.type?(n.emit("thumbnail",e,i.result),void(null!=t&&t())):n.createThumbnailFromUrl(e,i.result,t)}}(this),i.readAsDataURL(e)},n.prototype.createThumbnailFromUrl=function(e,t,i){var n;return n=document.createElement("img"),n.onload=function(t){return function(){var s,r,a,l,u,c,d,p;return e.width=n.width,e.height=n.height,a=t.options.resize.call(t,e),null==a.trgWidth&&(a.trgWidth=a.optWidth),null==a.trgHeight&&(a.trgHeight=a.optHeight),s=document.createElement("canvas"),r=s.getContext("2d"),s.width=a.trgWidth,s.height=a.trgHeight,o(r,n,null!=(u=a.srcX)?u:0,null!=(c=a.srcY)?c:0,a.srcWidth,a.srcHeight,null!=(d=a.trgX)?d:0,null!=(p=a.trgY)?p:0,a.trgWidth,a.trgHeight),l=s.toDataURL("image/png"),t.emit("thumbnail",e,l),null!=i?i():void 0}}(this),null!=i&&(n.onerror=i),n.src=t},n.prototype.enqueueFile=function(e){var t=this;if(e.status===n.ADDED&&e.accepted===!0)return this.emit("enqueuing",e),e.status=n.QUEUED,setTimeout(function(){return t.processQueue()},0);throw new Error("This file can't be enqueued because it has not been processed or was rejected.")},n.prototype.processQueue=function(){for(var e,t,i=this,s=this.getActiveFiles(),r=this.getWorkerCount();(e=s.shift())&&r<this.options.chunking.maxConcurrentWorkers;)if(e.status==n.QUEUED&&e.processed===!1)this.sign(e),r++;else if(!e.s3success&&e.upload.chunksSuccessful())this.finishUpload(e),r++;else if(e.s3success&&this.options.notifying.notify)this.emit("notify",e,function(e){i._finished(e)});else for(;(t=e.upload.getNextQueuedChunk())!==!1&&r<this.options.chunking.maxConcurrentWorkers;)this.uploadChunk(e,t),r++},c=function(e){var t,i,n,s,r,o;if(i=[],r=/%20/g,n=function(e,t){t="function"==typeof t?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)},e instanceof Array)for(s in e)n(s,e[s]);else for(t in e)d(t,e[t],n);return o=i.join("&").replace(r,"+")},d=function(e,t,i){var n,s,r,o;if(o=/\[\]$/,t instanceof Array)for(s=0,r=t.length;r>s;s++)o.test(e)?i(e,t[s]):d(e+"["+("object"==typeof t[s]?s:"")+"]",t[s],i);else if("object"==typeof t)for(n in t)d(e+"["+n+"]",t[n],i);else i(e,t)},n.prototype.sign=function(e){var t=this,i={};if(e.processed!==!1||e.accepted!==!0)throw new Error("This file can't be processed because it has already been processed or was rejected.");var s=new XMLHttpRequest;s.onload=function(){var i={};if(s.status/100==2){try{i=JSON.parse(s.responseText)}catch(r){return t._fatalError(e,r.message)}if(i.region=t.options.s3.region,i.bucket=t.options.s3.bucket,i.access_key=t.options.s3.accesskey,i.acl=t.options.s3.acl,t.options.resuming.localStorageResume===!0&&t.options.validation.allowDuplicates===!1){var o;(o=window.localStorage.getItem(t.options.resuming.localStoragePrefix+JSON.stringify({n:e.name,s:e.size,l:e.lastModified})))&&(o=JSON.parse(o),i.uploadId=o.u,i.key=o.k)}t.emit("filesigned",e,i,function(){e.upload.init(i,i.key,t.options.s3.ssencrypt,function(i){e.processed=!0,i?t._finished(e):(t.options.resuming.localStorageResume===!0&&t.options.validation.allowDuplicates===!1&&window.localStorage.setItem(t.options.resuming.localStoragePrefix+JSON.stringify({n:e.name,s:e.size,l:e.lastModified}),JSON.stringify({u:e.upload.auth.uploadId,k:e.upload.auth.key})),t.emit("fileinit",e,function(){return e.status=n.QUEUED,setTimeout(function(){return t.processQueue()},0)}))},function(i){var n=[0,500,503];return-1!=n.indexOf(i.target.status)||400==i.target.status&&-1!==i.target.responseText.indexOf("RequestTimeout")?t._recoverableError(e,i.target):t._fatalError(e,t.options.dictResponseError.replace("{{statusCode}}",i.target.status),i.target)})})}else{if(s.status/100!=5)return t._fatalError(e,t.options.dictResponseError.replace("{{statusCode}}",s.status),s);t._recoverableError(e,s.status)}},s.onerror=s.ontimeout=function(i){return t._recoverableError(e,i.target)},e.status=n.PROCESSING,i.filename=e.name,i.filesize=e.size,i.filemime=e.type,u(i,this.options.signing.params),this.emit("sign",e,s,i),s.timeout=2e4,s.open("POST",this.options.signing.endpoint,!0),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.send(c(i))},n.prototype.uploadChunk=function(e,t){e.status=n.UPLOADING,this.emit("sending",e);var i=function(e,t,i){return function(n){t.paused===!0&&t.upload.chunks[i].bytesSent<n.loaded&&(e.emit("resumed",t),t.paused=!1),t.upload.setChunkProgress(i,n.loaded),t.upload.progressDate=new Date,e.emit("uploadprogress",t,t.upload.getTotalProgress(),t.upload.getBytesSent())}}(this,e,t),s=function(e,t,i){return function(s){t.status!==n.CANCELED&&(t.retryAttemptsRemaining=e.options.resuming.retryAttempts,t.upload.setChunkComplete(i),e.emit("uploadprogress",t,t.upload.getTotalProgress(),t.upload.getBytesSent()),setTimeout(function(){e.processQueue()},0))}}(this,e,t),r=function(e,t,i){return function(s){if(t.status!==n.CANCELED){t.upload.resetChunk(i),e.emit("uploadprogress",t,t.upload.getTotalProgress(),t.upload.getBytesSent());var r=[0,500,503];return-1!=r.indexOf(s.target.status)||400==s.target.status&&-1!==s.target.responseText.indexOf("RequestTimeout")?(t.upload.resetChunk(i),e.emit("uploadprogress",t,t.upload.getTotalProgress(),t.upload.getBytesSent()),e._recoverableError(t,s.target)):e._fatalError(t,e.options.dictResponseError.replace("{{statusCode}}",s.target.status),s.target)}}}(this,e,t);e.upload.uploadChunk(t,s,r,i)},n.prototype.pauseFile=function(e,t){var i=[n.PROCESSING,n.UPLOADING,n.FINISHING,n.NOTIFYING];-1!=i.indexOf(e.status)&&(e.status=n.PAUSED,e.paused=!0,this.emit("pause",e,t))},n.prototype.resumeFile=function(e){var t=this;return e.status===n.PAUSED?(e.status=n.QUEUED,t.emit("resume",e),setTimeout(function(){return t.processQueue()},0)):void 0},n.prototype.cancelUpload=function(e){var t=this;return e.upload.abort(a,function(e,t){return function(i){var n=[0,500,503];return-1!=n.indexOf(i.target.status)||400==i.target.status&&-1!==i.target.responseText.indexOf("RequestTimeout")?e._recoverableError(t,i.target):e._fatalError(t,e.options.dictResponseError.replace("{{statusCode}}",i.target.status),i.target)}}(this,e)),e.status=n.CANCELED,this.emit("canceled",e),setTimeout(function(){return t.processQueue()},0)},n.prototype.removeFile=function(e){return window.localStorage.removeItem(this.options.resuming.localStoragePrefix+JSON.stringify({n:e.name,s:e.size,l:e.lastModified})),e.processed===!0?this.cancelUpload(e):e.upload.reset(),this.files=l(this.files,e),this.emit("removedfile",e),0===this.files.length?this.emit("reset"):void 0},n.prototype.removeAllFiles=function(e){var t,i,n,s;for(null==e&&(e=!1),s=this.files.slice(),i=0,n=s.length;n>i;i++)t=s[i],(t.processed===!1||e)&&this.removeFile(t);return null},n.prototype.finishUpload=function(e){e.status=n.FINISHING,this.emit("finishing",e);var t=function(e,t){return function(i){t.s3success=!0,window.localStorage.removeItem(e.options.resuming.localStoragePrefix+JSON.stringify({n:t.name,s:t.size,l:t.lastModified})),e.emit("notify",t,function(t){e._finished(t)})}}(this,e),i=function(e,t){return function(i){return t.status=n.UPLOADING,setTimeout(function(){return e.processQueue()},0)}}(this,e),s=function(e,t){return function(i){var n=[0,500,503];return-1!=n.indexOf(i.target.status)||400==i.target.status&&-1!==i.target.responseText.indexOf("RequestTimeout")?e._recoverableError(t,i.target):e._fatalError(t,e.options.dictResponseError.replace("{{statusCode}}",i.target.status),i.target)}}(this,e);e.upload.finishUpload(t,i,s)},n.prototype._finished=function(e,t,i){var s=this;return e.status=n.SUCCESS,e.paused===!0&&(s.emit("resumed",e),e.paused=!1),this.emit("success",e,t,i),this.emit("complete",e),setTimeout(function(){return s.processQueue()},0)},n.prototype._recoverableError=function(e,t){var i=this;if(e.status!=n.PAUSED)return this.options.resuming.automaticRetry&&(0===this.options.resuming.retryAttempts||e.retryAttemptsRemaining>0)?(this.pauseFile(e,this.options.dictConnectionError.replace("{{seconds}}",this.options.resuming.retryInterval)),e.retryAttemptsRemaining-=1,setTimeout(function(){i.resumeFile(e)},1e3*i.options.resuming.retryInterval)):void this.pauseFile(e,i.options.dictResumeUpload)},n.prototype._fatalError=function(e,t,i){var s=this;return e.status=n.ERROR,e.paused===!0&&(s.emit("resumed",e),e.paused=!1),window.localStorage.removeItem(this.options.resuming.localStoragePrefix+JSON.stringify({n:e.name,s:e.size,l:e.lastModified})),this.emit("error",e,t,i),this.emit("complete",e),setTimeout(function(){return s.processQueue()},0)},n}(i),n.version="0.1",n.options={},n.optionsForElement=function(e){return e.getAttribute("id")?n.options[s(e.getAttribute("id"))]:void 0},n.instances=[],n.forElement=function(e){if("string"==typeof e&&(e=document.querySelector(e)),null==(null!=e?e.dropzone:void 0))throw new Error("No DropzoneS3 found for given element. This is probably because you're trying to access it before DropzoneS3 had the time to initialize. Use the `init` option to setup any additional observers on your DropzoneS3.");return e.dropzone},n.blacklistedBrowsers=[/opera.*Macintosh.*version\/12/i],n.isBrowserSupported=function(){var e,t,i,s,r;if(e=!0,window.File&&window.FileReader&&window.FileList&&window.Blob&&window.FormData&&document.querySelector&&window.localStorage)if("classList"in document.createElement("a"))for(r=n.blacklistedBrowsers,i=0,s=r.length;s>i;i++)t=r[i],t.test(navigator.userAgent)&&(e=!1);else e=!1;else e=!1;return e},l=function(e,t){var i,n,s,r;for(r=[],n=0,s=e.length;s>n;n++)i=e[n],i!==t&&r.push(i);return r},s=function(e){return e.replace(/[\-_](\w)/g,function(e){return e.charAt(1).toUpperCase()})},n.createElement=function(e){var t;return t=document.createElement("div"),t.innerHTML=e,t.childNodes[0]},n.elementInside=function(e,t){if(e===t)return!0;for(;e=e.parentNode;)if(e===t)return!0;return!1},n.getElement=function(e,t){var i;if("string"==typeof e?i=document.querySelector(e):null!=e.nodeType&&(i=e),null==i)throw new Error("Invalid `"+t+"` option provided. Please provide a CSS selector or a plain HTML element.");return i},n.getElements=function(e,t){var i,n,s,r,o,a,l,u;if(e instanceof Array){s=[];try{for(r=0,a=e.length;a>r;r++)n=e[r],s.push(this.getElement(n,t))}catch(c){i=c,s=null}}else if("string"==typeof e)for(s=[],u=document.querySelectorAll(e),o=0,l=u.length;l>o;o++)n=u[o],s.push(n);else null!=e.nodeType&&(s=[e]);if(null==s||!s.length)throw new Error("Invalid `"+t+"` option provided. Please provide a CSS selector, a plain HTML element or a list of those.");return s},n.confirm=function(e,t,i){return window.confirm(e)?t():null!=i?i():void 0},n.isValidFile=function(e,t){var i,n,s,r,o;if(!t)return!0;for(t=t.split(","),n=e.type,i=n.replace(/\/.*$/,""),r=0,o=t.length;o>r;r++)if(s=t[r],s=s.trim(),"."===s.charAt(0)){if(-1!==e.name.toLowerCase().indexOf(s.toLowerCase(),e.name.length-s.length))return!0}else if(/\/\*$/.test(s)){if(i===s.replace(/\/.*$/,""))return!0}else if(n===s)return!0;return!1},"undefined"!=typeof jQuery&&null!==jQuery&&(jQuery.fn.dropzone=function(e){return this.each(function(){return new n(this,e)})}),"undefined"!=typeof module&&null!==module?module.exports=n:window.DropzoneS3=n,n.ADDED="added",n.QUEUED="queued",n.PROCESSING="processing",n.UPLOADING="uploading",n.PAUSED="paused",n.FINISHING="finishing",n.NOTIFYING="notifying",n.CANCELED="canceled",n.ERROR="error",n.SUCCESS="success",r=function(e){var t,i,n,s,r,o,a,l,u,c;for(a=e.naturalWidth,o=e.naturalHeight,i=document.createElement("canvas"),i.width=1,i.height=o,n=i.getContext("2d"),n.drawImage(e,0,0),s=n.getImageData(0,0,1,o).data,c=0,r=o,l=o;l>c;)t=s[4*(l-1)+3],0===t?r=l:c=l,l=r+c>>1;return u=l/o,0===u?1:u},o=function(e,t,i,n,s,o,a,l,u,c){var d;return d=r(t),e.drawImage(t,i,n,s,o,a,l,u,c/d)}}).call(this);
